{% extends 'base.html.twig' %}
{% block sidebar %}
{% endblock %}

{% block body %}

    <h3 class="text-secondary mt-4">{{ academico.nombre|title }} {{ academico.apellido|title }} <small>- Ejercicio {{ year }}</small></h3>

    {#<div class="card-deck">#}
        {#<div class="card">#}
            {#<div class="card-body">#}
                {#<h5 class="card-title">Erogado Licencias</h5>#}
                {#<h4>${{ asignacionLicencia |number_format(2)}}</h4>#}
            {#</div>#}
        {#</div>#}
        {#<div class="card">#}
            {#<div class="card-body">#}
                {#<h5 class="card-title">Card title</h5>#}
                {#<p class="card-text">This card has supporting text below as a natural lead-in to additional content.</p>#}
                {#<p class="card-text"><small class="text-muted">Last updated 3 mins ago</small></p>#}
            {#</div>#}
        {#</div>#}
        {#<div class="card">#}
            {#<div class="card-body">#}
                {#<h5 class="card-title">Card title</h5>#}
                {#<p class="card-text">This is a wider card with supporting text below as a natural lead-in to additional content. This card has even longer content than the first to show that equal height action.</p>#}
                {#<p class="card-text"><small class="text-muted">Last updated 3 mins ago</small></p>#}
            {#</div>#}
        {#</div>#}
    {#</div>#}

    {% if year == 2018 %}
        <div class="lead my-4 text-secondary">Ver histórico: <a href="{{ path('academico_show', {'slug': academico.slug, 'year': '2017' }) }}">2017</a></div>
    {% else %}
        <div class="lead my-4 text-secondary">Ver año actual: <a href="{{ path('academico_show', {'slug': academico.slug, 'year': '2018' }) }}">2018</a></div>
    {% endif %}

    <div class="card-deck mb-4 text-muted">
        <div class="card">
            <div class="card-body">
                <div class="mb-2">Erogado Licencias</div>
                <h4>${{ asignacionLicencia |number_format(2)}}</h4>
            </div>
        </div>
        <div class="card">
            <div class="card-body">
                <div class="mb-2">Días Licencia</div>
                <h4>{{ diasLicencia }}</h4>
            </div>
        </div>
        <div class="card">
            <div class="card-body">
                <div class="mb-2">Erogado Comisiones</div>
                <h4>${{ asignacionComision |number_format(2)}}</h4>
            </div>
        </div>
        <div class="card">
            <div class="card-body">
                <div class="mb-2">Días Comisiones</div>
                <h4>{{ diasComision }}</h4>
            </div>
        </div>
        <div class="card">
            <div class="card-body">
                <div class="mb-2">Erogado Visitantes</div>
                <h4>${{ asignacionVisitante |number_format(2)}}</h4>
            </div>
        </div>
    </div>

    {#<table  class="table table-condensed table-bordered text-secondary">#}
        {#<thead>#}
        {#<tr><th>Erogado Licencias</th><th>Días Licencia</th><th>Erogado Comisiones</th><th>Días Comisiones</th><th>Erogado Visitantes</th></tr>#}
        {#</thead>#}
        {#<tbody>#}
        {#<tr><td><h4>${{ asignacionLicencia |number_format(2)}}</h4></td>#}
            {#<td><h4>{{ diasLicencia }}</h4></td>#}
            {#<td><h4>${{ asignacionComision |number_format(2)}}</h4></td>#}
            {#<td><h4>{{ diasComision }}</h4></td>#}
            {#<td><h4>${{ asignacionVisitante |number_format(2)}}</h4></td></tr>#}
        {#</tbody>#}
    {#</table>#}

    {% set totalErogado = asignacionLicencia + asignacionComision + asignacionVisitante %}
    {% set saldo = asignacionAnual - totalErogado %}

    <div class="row my-4">
        <div class="col-lg-3 lead text-info">
            <h3>Saldo: ${{ saldo |number_format(2)}}</h3>
        </div>
        <div class="col-lg-3 lead text-info">
            <h3>Días: {{ totalDias - diasLicencia - diasComision}}</h3>
        </div>
    </div>

    <a href="{{ path('solicitud_step') }}" class="btn btn-info mb-5" role="button"><i class="fa fa-plus"></i> Crear nueva solicitud</a>

    <h4 class="text-secondary mb-4">Licencias</h4>
    {# Solicitudes #}
    <table class="table">
        <thead>
        <tr><th>Tipo de solicitud</th><th>Financiamiento CCM</th><th>Fecha</th></tr>
        </thead>
        <tbody>
        {% for solicitud in solicitudes %}
            {# Muestra solo licitudes del año vigente #}
            {% if solicitud.fechaInicio >= '2018-01-01'  %}
                <tr>
                    <td>
                        <a href="{{ path('solicitud_show', {'id': solicitud.id }) }}">{{ solicitud.tipo }}</a>
                    </td>
                    {% set ccm = 0 %}
                    {% for financiamiento in solicitud.financiamiento %}
                        {% set ccm = financiamiento.ccm + ccm %}
                    {% endfor %}
                    <td> ${{ ccm | number_format(2)}}</td>
                    <td>
                        del {{ solicitud.fechaInicio | localizeddate('medium', 'none', null, null, "d LLL") }} al {{ solicitud.fechaFin| localizeddate('medium', 'none', null, null, "d LLL Y") }}
                    </td>
                </tr>
            {% endif %}
        {% endfor %}
        </tbody>
    </table>

    {#<h1>Academico</h1>#}

    {#<table>#}
        {#<tbody>#}
            {#<tr>#}
                {#<th>Id</th>#}
                {#<td>{{ academico.id }}</td>#}
            {#</tr>#}
            {#<tr>#}
                {#<th>Nombre</th>#}
                {#<td>{{ academico.nombre }}</td>#}
            {#</tr>#}
            {#<tr>#}
                {#<th>Apellido</th>#}
                {#<td>{{ academico.apellido }}</td>#}
            {#</tr>#}
            {#<tr>#}
                {#<th>Nacimiento</th>#}
                {#<td>{% if academico.nacimiento %}{{ academico.nacimiento|date('Y-m-d') }}{% endif %}</td>#}
            {#</tr>#}
            {#<tr>#}
                {#<th>Rfc</th>#}
                {#<td>{{ academico.rfc }}</td>#}
            {#</tr>#}
            {#<tr>#}
                {#<th>Activo</th>#}
                {#<td>{% if academico.activo %}Yes{% else %}No{% endif %}</td>#}
            {#</tr>#}
            {#<tr>#}
                {#<th>Slug</th>#}
                {#<td>{{ academico.slug }}</td>#}
            {#</tr>#}
            {#<tr>#}
                {#<th>Created</th>#}
                {#<td>{% if academico.created %}{{ academico.created|date('Y-m-d H:i:s') }}{% endif %}</td>#}
            {#</tr>#}
            {#<tr>#}
                {#<th>Modified</th>#}
                {#<td>{% if academico.modified %}{{ academico.modified|date('Y-m-d H:i:s') }}{% endif %}</td>#}
            {#</tr>#}
        {#</tbody>#}
    {#</table>#}

    {#<ul>#}
        {#<li>#}
            {#<a href="{{ path('academico_index') }}">Back to the list</a>#}
        {#</li>#}
        {#<li>#}
            {#<a href="{{ path('academico_edit', { 'id': academico.id }) }}">Edit</a>#}
        {#</li>#}
        {#<li>#}
            {#{{ form_start(delete_form) }}#}
                {#<input type="submit" value="Delete">#}
            {#{{ form_end(delete_form) }}#}
        {#</li>#}
    {#</ul>#}
{% endblock %}
